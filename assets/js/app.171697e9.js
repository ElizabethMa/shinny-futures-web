(function(t){function e(e){for(var n,o,a=e[0],c=e[1],u=e[2],d=0,h=[];d<a.length;d++)o=a[d],s[o]&&h.push(s[o][0]),s[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);l&&l(e);while(h.length)h.shift()();return r.push.apply(r,u||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],n=!0,a=1;a<i.length;a++){var c=i[a];0!==s[c]&&(n=!1)}n&&(r.splice(e--,1),t=o(o.s=i[0]))}return t}var n={},s={app:0},r=[];function o(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=n,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(i,n,function(e){return t[e]}.bind(null,n));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/shinny-futures-web/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var u=0;u<a.length;u++)e(a[u]);var l=c;r.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"0749":function(t,e,i){"use strict";var n=i("b885"),s=i.n(n);s.a},"0894":function(t,e,i){"use strict";var n=i("2262"),s=i.n(n);s.a},"0be0":function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n=i("d4ec"),s=i("bee2"),r=function(){function t(){Object(n["a"])(this,t),this.handlers={}}return Object(s["a"])(t,[{key:"addEventListener",value:function(t,e){void 0===this.handlers[t]&&(this.handlers[t]=[]),this.handlers[t].push(e)}},{key:"removeEventListener",value:function(t,e){if(this.handlers[t]instanceof Array){for(var i=this.handlers[t],n=0;n<i.length;n++)if(i[n]===e){this.handlers[t].splice(n,1);break}0===this.handlers[t].length&&delete this.handlers[t]}}},{key:"fire",value:function(t,e){if(this.handlers[t]instanceof Array)for(var i=this.handlers[t],n=0;n<i.length;n++)i[n](e)}}]),t}()},1578:function(t,e,i){},"1f5e":function(t,e,i){"use strict";var n=i("5291"),s=i.n(n);s.a},2262:function(t,e,i){},"241c":function(t,e,i){"use strict";var n=i("cfab"),s=i.n(n);s.a},2770:function(t,e,i){},"2b71":function(t,e,i){"use strict";var n=i("1578"),s=i.n(n);s.a},"491c":function(t,e,i){},"4bbc":function(t,e,i){},"4da7":function(t,e,i){"use strict";i("6762"),i("2fdb"),i("cadf"),i("551c"),i("097d");var n=i("dfaa"),s=(i("28a5"),i("53ca")),r=(i("ac6a"),i("456d"),i("d4ec")),o=i("bee2"),a=i("99de"),c=i("7e84"),u=i("262e"),l=i("0be0"),d=function(t){function e(){var t;arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(r["a"])(this,e),t=Object(a["a"])(this,Object(c["a"])(e).call(this)),t._data={},t._epoch=0,t}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"getByPath",value:function(t){for(var e=h(t),i=this._data,n=0;n<e.length;n++)if(i=i[e[n]],void 0===i)break;return n<e.length-1?{}:i}},{key:"asyncGetByPath",value:function(t,e){var i=this.getByPath(t);e(i)}},{key:"mergeData",value:function(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(i&&(this._epoch+=1),Array.isArray(t))for(var s in t)Object.keys(t[s]).length>0&&e.mergeObject(this._data,t[s],this._epoch,n);else e.mergeObject(this._data,t,this._epoch,n);for(var r in this.handlers){var o=h(r),a=this.isChanging(o,t);a&&this.fire(r,this.getByPath(o))}}},{key:"isChanging",value:function(t,e){for(var i=h(t),n=this._data,r=0;r<i.length;r++)if(n=n[i[r]],void 0===n)return!1;if("object"===Object(s["a"])(n))return!(!n._epoch||n._epoch!==this._epoch);if(e){for(var o=e,a=0;a<i.length;a++)if(o=o[i[a]],void 0===o)return!1;return!0}return!1}},{key:"subscribe",value:function(t,e){this.addEventListener(t,e)}},{key:"unsubscribe",value:function(t,e){this.removeEventListener(t,e)}}],[{key:"mergeObject",value:function(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];for(var o in i){var a=i[o];switch(Object(s["a"])(a)){case"object":if(null===a){r&&delete t[o];continue}Array.isArray(a)||"data"===o?o in t||(t[o]=[]):o in t||(t[o]={}),e.mergeObject(t[o],a,n,r);break;case"string":case"boolean":case"number":t[o]="NaN"===a?NaN:a;break;case"undefined":break}}t["_epoch"]||Object.defineProperty(t,"_epoch",{configurable:!1,enumerable:!1,writable:!0}),t["_epoch"]=n}}]),e}(l["a"]);function h(t){return t instanceof Array||(t=t.split("/")),t.filter(function(t){return""!==t})}var _=i("db49");i.d(e,"b",function(){return m}),i.d(e,"c",function(){return f}),i.d(e,"a",function(){return p}),i.d(e,"d",function(){return b});var m=new n["a"](_["c"]),f=new n["a"](_["e"]),p=new d;function b(t){m.addEventListener("message",function(e){if("rtn_data"===e.aid)for(var i in e.data)t.commit("MERGE_QUOTE_WS_DATA",e.data[i]);m.send('{"aid":"peek_message"}')}),f.addEventListener("message",function(e){switch(e.aid){case"rtn_data":for(var i in e.data)t.commit("MERGE_TRADE_WS_DATA",e.data[i]);f.send('{"aid":"peek_message"}');break;case"rtn_brokers":t.commit("SET_BROKERS",e.brokers)}}),m.addEventListener("open",function(){t.commit("SET_WS_CONNECT_STATUS",{quoteWsConnected:!0})}),f.addEventListener("open",function(){t.commit("SET_WS_CONNECT_STATUS",{tradeWsConnected:!0})}),m.addEventListener("close",function(){t.commit("SET_WS_CONNECT_STATUS",{quoteWsConnected:!1})}),f.addEventListener("close",function(){t.commit("SET_WS_CONNECT_STATUS",{tradeWsConnected:!1})}),t.subscribe(function(t){["LOGIN","INSERT_ORDER","CANCEL_ORDER","TRANSFER"].includes(t.type)&&f.send('{"aid":"peek_message"}')})}m.addEventListener("message",function(t){"rtn_data"===t.aid&&p.mergeData(t.data)})},5291:function(t,e,i){},"55b5":function(t,e,i){"use strict";var n=i("2770"),s=i.n(n);s.a},"56d7":function(t,e,i){"use strict";i.r(e);i("cadf"),i("551c"),i("097d");var n=i("2b0e"),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Layout",{attrs:{id:"shinny-app"}},[i("Sider",{staticClass:"sider",attrs:{width:"60"}},[i("Tooltip",{attrs:{content:"设置",placement:"right"}},[i("Button",{attrs:{type:"text",size:"small",to:"https://www.shinnytech.com/tianqin/",target:"_blank"}},[i("Icon",{attrs:{type:"md-settings",size:"40"}})],1)],1),i("Tooltip",{attrs:{content:"打开天勤主页",placement:"right"}},[i("Button",{attrs:{type:"text",size:"small",to:"https://www.shinnytech.com/tianqin/",target:"_blank"}},[i("Icon",{attrs:{type:"md-share-alt",size:"40"}})],1)],1)],1),i("Content",{staticClass:"content"},[i("Split",{attrs:{mode:"vertical"},model:{value:t.$root.appSplit,callback:function(e){t.$set(t.$root,"appSplit",e)},expression:"$root.appSplit"}},[i("div",{staticClass:"split-pane",attrs:{slot:"top"},slot:"top"},[i("keep-alive",[i("router-view",{attrs:{name:"quotes"}})],1)],1),i("div",{staticClass:"split-horizontal",attrs:{slot:"trigger"},slot:"trigger"},[i("div",{staticClass:"split-horizontal-dots"},[i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"})])]),i("div",{staticClass:"split-pane",attrs:{slot:"bottom"},slot:"bottom"},[i("router-view",{attrs:{name:"user"}})],1)])],1)],1)},r=[],o={data:function(){return{}},computed:{quoteWsConnected:function(){return this.$store.state.quoteWsConnected},tradeWsConnected:function(){return this.$store.state.tradeWsConnected}}},a=o,c=(i("5c0b"),i("2877")),u=Object(c["a"])(a,s,r,!1,null,null,null);u.options.__file="App.vue";var l=u.exports,d=i("e069"),h=i.n(d);i("dcad");n["default"].use(h.a,{transfer:!0,size:"default"});var _=i("8c4f"),m=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"quotes-container",staticStyle:{height:"100%"}},[i("SplitLeftRight",{attrs:{split:.8}},[i("template",{slot:"left"},[i("div",{staticClass:"top-content"},[i("ButtonsLine",{attrs:{tags:t.tags,defaultTag:t.defaultTag},on:{change:t.handlerChangeTag}})],1),i("div",{staticClass:"bottom-content",staticStyle:{top:"28px"}},[i("table-quotes",{attrs:{contentList:t.quotesList,tableCol:t.quotesTableRow,rootPath:t.rootPath}})],1)]),i("template",{slot:"right"},[i("div",{staticClass:"top-content"},[i("quote-info",{attrs:{instrumentId:t.instrumentId}})],1),i("div",{staticClass:"bottom-content",staticStyle:{top:"220px"}},[i("ticks-list",{attrs:{instrumentId:t.instrumentId}})],1)])],2)],1)},f=[],p=(i("a481"),i("be94")),b=i("2f62"),g=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tq-table-container",style:{height:"100%"},on:{scroll:t.handleScroll}},[i("table",{attrs:{id:"QuotesTable"}},[i("thead",[i("tr",t._l(t.tableCol,function(e){return i("td",[i("div",{style:t.computeStyleObj(e)},[t._v(t._s(e["name"]))])])}))]),i("tbody",t._l(t.contentList,function(e,n){return i("table-row",{key:e,class:{selected:e===t.selectedSymbol},attrs:{symbol:e,path:t.rootPath+e+"/",tableCol:t.tableCol},on:{rowClick:t.rowClick,rowDbClick:t.rowDbClick}})}))])])},v=[],y=(i("6762"),i("2fdb"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("tr",{on:{click:t.handlerClick,dblclick:t.handlerDbClick}},[i("td",[i("div",[t._v(t._s(t.ins_name))]),i("div",{staticClass:"appendix"},[t._v(t._s(t.ins_id))])]),t._l(t.tableCol,function(e,n){return n>0?i("td",{class:t.classNameStr(e)},[i("div",{staticClass:"data-content",style:t.styleObj(e),attrs:{"data-content":t.formatter(e)}})]):t._e()})],2)}),E=[],k={data:function(){return{priceDecs:0,priceTick:1,ins_id:"",ins_name:"",quote:{}}},components:{},props:{tableCol:{type:Array},symbol:{type:String},path:{type:String}},beforeMount:function(){this.quote=this.getQuote(this.symbol),this.priceDecs=this.quote.price_decs,this.priceTick=this.quote.price_tick,this.ins_name=this.quote.ins_name,"FUTURE_CONT"===this.quote.class?this.ins_id=this.quote.underlying_symbol:"FUTURE_INDEX"===this.quote.class?this.ins_id=this.quote.underlying_product:this.ins_id=this.quote.instrument_id},mounted:function(){},updated:function(){},beforeDestroy:function(){},computed:Object(p["a"])({},Object(b["b"])({getQuote:"quotes/GET_QUOTE"})),methods:{classNameStr:function(t){return"function"===typeof t["className"]?t["className"](this.quote):t["className"]},styleObj:function(t){var e={};return t["width"]&&(e["width"]=t["width"]+"px"),e},formatter:function(t){return t.formatter?t.formatter(this.quote):this.quote[t.prop]},handlerClick:function(){this.$emit("rowClick",this.quote)},handlerDbClick:function(){this.$emit("rowDbClick",this.quote)},handlerRowContextmenu:function(t){t.stopPropagation(),t.preventDefault(),this.$emit("rowContextmenu",this.quote)}}},T=k,w=Object(c["a"])(T,y,E,!1,null,null,null);w.options.__file="TableQuotesRow.vue";var S=w.exports,C={data:function(){return{selectedSymbol:""}},components:{TableRow:S},props:{height:{type:String},tableCol:{type:Array},contentList:{type:Array},rootPath:{type:String}},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},mounted:function(){},beforeDestroy:function(){},computed:{},methods:{handleScroll:function(t){},computeStyleObj:function(t){var e={};return t["width"]&&(e["width"]=t["width"]+"px"),e},rowClick:function(t){this.$store.commit("SET_SELECTED_SHOW_SYMBOL",t.instrument_id),"FUTURE"===t.class?this.$store.commit("SET_SELECTED_SYMBOL",t.instrument_id):"FUTURE_CONT"===t.class&&this.$store.commit("SET_SELECTED_SYMBOL",t.underlying_symbol),this.selectedSymbol=t.instrument_id},rowDbClick:function(t){this.$router.push({name:"charts",params:{instrument_id:t.instrument_id}})},cellStyle:function(t){var e=t.row,i=t.column;t.rowIndex,t.columnIndex;return["最新价","涨跌","涨跌幅","今开盘","最高价","最低价"].includes(i.label)&&e.change%1===0&&0!==e.change?{color:e.change>0?"red":"green"}:{color:"black"}}}},O=C,P=(i("ab6f"),Object(c["a"])(O,g,v,!1,null,null,null));P.options.__file="Table.vue";var D=P.exports,x=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.quote?i("div",{staticClass:"quoteinfo-container"},[i("Row",[i("Col",{attrs:{span:"12"}},[i("div",[t._v(t._s(t.quote.ins_name))])]),i("Col",{attrs:{span:"12"}},[i("div",[t._v(t._s(t.instrumentId))])])],1),i("div",{staticClass:"contrast"},[i("Row",[i("Col",{attrs:{span:"6"}},[i("div",[t._v("卖一")])]),i("Col",{attrs:{span:"6"}},[i("div",[t._v(t._s(t.formatter(t.quote.ask_price1)))])]),i("Col",{attrs:{span:"6"}},[t._v("\n            "+t._s(t.quote.ask_volume1)+"\n            ")]),i("Col",{attrs:{span:"6"}})],1),i("div",{staticClass:"outer"},[i("div",{staticClass:"inner",style:{width:100*t.innerWidth+"%"}})]),i("Row",[i("Col",{attrs:{span:"6"}},[t._v("\n            买一")]),i("Col",{attrs:{span:"6"}},[t._v("\n            "+t._s(t.formatter(t.quote.bid_price1)))]),i("Col",{attrs:{span:"6"}},[t._v("\n            "+t._s(t.quote.bid_volume1))]),i("Col",{attrs:{span:"6"}})],1)],1),i("Row",[i("Col",{attrs:{span:"6"}},[t._v("\n        最新价")]),i("Col",{class:t.classOfColor,attrs:{span:"6"}},[t._v("\n        "+t._s(t.formatter(t.quote.last_price)))]),i("Col",{attrs:{span:"6"}},[t._v("\n        昨结算")]),i("Col",{attrs:{span:"6"}},[t._v("\n        "+t._s(t.formatter(t.quote.pre_settlement)))])],1),i("Row",[i("Col",{attrs:{span:"6"}},[t._v("\n        涨跌")]),i("Col",{class:t.classOfColor,attrs:{span:"6"}},[t._v("\n        "+t._s(t.formatter(t.quote.change)))]),i("Col",{attrs:{span:"6"}},[t._v("\n        今开")]),i("Col",{attrs:{span:"6"}},[t._v("\n        "+t._s(t.quote.open))])],1),i("Row",[i("Col",{attrs:{span:"6"}},[t._v("\n        涨跌幅")]),i("Col",{class:t.classOfColor,attrs:{span:"6"}},[t._v("\n        "+t._s(t.change_present))]),i("Col",{attrs:{span:"6"}},[t._v("\n        最高")]),i("Col",{attrs:{span:"6"}},[t._v("\n        "+t._s(t.formatter(t.quote.highest)))])],1),i("Row",[i("Col",{attrs:{span:"6"}},[t._v("\n        总手")]),i("Col",{class:t.classOfColor,attrs:{span:"6"}},[t._v("\n        "+t._s(t.quote.volume))]),i("Col",{attrs:{span:"6"}},[t._v("\n        最低")]),i("Col",{attrs:{span:"6"}},[t._v("\n        "+t._s(t.formatter(t.quote.lowest)))])],1),i("Row",[i("Col",{attrs:{span:"6"}},[t._v("\n        涨停")]),i("Col",{staticClass:"R",attrs:{span:"6"}},[t._v("\n        "+t._s(t.formatter(t.quote.upper_limit)))]),i("Col",{attrs:{span:"6"}},[t._v("\n        收盘")]),i("Col",{attrs:{span:"6"}},[t._v("\n        "+t._s(t.formatter(t.quote.close)))])],1),i("Row",[i("Col",{attrs:{span:"6"}},[t._v("\n        跌停")]),i("Col",{staticClass:"G",attrs:{span:"6"}},[t._v("\n        "+t._s(t.formatter(t.quote.lower_limit)))]),i("Col",{attrs:{span:"6"}},[t._v("\n        结算")]),i("Col",{attrs:{span:"6"}},[t._v("\n        "+t._s(t.formatter(t.quote.settlement)))])],1),i("Row",[i("Col",{attrs:{span:"6"}},[t._v("\n        持仓量")]),i("Col",{attrs:{span:"6"}},[t._v("\n        "+t._s(t.quote.open_interest))]),i("Col",{attrs:{span:"6"}},[t._v("\n        日增")]),i("Col",{attrs:{span:"6"}},[t._v("\n        "+t._s(t.quote.open_interest-t.quote.pre_open_interest))])],1)],1):t._e()},I=[],L=i("d930"),j={data:function(){return{}},props:{instrumentId:String},computed:{classOfColor:function(){return this.quote["change"]>0?"R":this.quote["change"]<0?"G":""},innerWidth:function(){return this.quote.bid_volume1/(this.quote.bid_volume1+this.quote.ask_volume1)},quote:function(){return this.$store.getters["quotes/GET_QUOTE"](this.instrumentId)},change_present:function(){var t=Object(L["d"])(this.quote["change"]/this.quote["pre_settlement"]*100,2);return isNaN(t)?"-":t+"%"}},methods:{formatter:function(t){return Object(L["d"])(t,this.quote.price_decs)}}},R=j,N=(i("0749"),Object(c["a"])(R,x,I,!1,null,"eee12218",null));N.options.__file="QuoteInfo.vue";var q=N.exports,A=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tickslist-container",style:{height:t.height}},[i("table",[t._m(0),t.quote?i("tbody",t._l(t.ticks,function(e,n){return i("tr",{key:n},[i("td",[t._v(t._s(e.dt))]),i("td",{class:e.textColor},[t._v(t._s(e.price))]),i("td",{class:e.textColor},[t._v(t._s(e.vol))]),i("td",[t._v(t._s(e.oi))]),i("td",{class:e.textColor},[t._v(t._s(e.msg))])])})):t._e()])])},M=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("thead",[i("tr",[i("td",[t._v("时间")]),i("td",[t._v("价位")]),i("td",[t._v("现手")]),i("td",[t._v("增仓")]),i("td",[t._v("开平")])])])}],U=i("4da7"),W={data:function(){return{ticks:[]}},watch:{instrumentId:{handler:function(t,e){this.$store.commit("SET_TICK_CHART",{symbol:t}),this.ticks.splice(0),U["a"].unsubscribe("ticks/"+e,this.update),U["a"].subscribe("ticks/"+t,this.update),this.update(U["a"].getByPath("ticks/"+t))},immediate:!0}},props:{instrumentId:String,height:String},computed:{quote:function(){return this.$store.getters["quotes/GET_QUOTE"](this.instrumentId)}},methods:{genOneTick:function(t,e){var i=e.data[t],n=e.data[t-1];if(this.quote&&i&&n&&i.volume-n.volume>0){var s=i.volume-n.volume,r=i.open_interest-n.open_interest,o={datetime:i.datetime,dt:Object(L["a"])(i.datetime).slice(11,19),price:Object(L["d"])(i.last_price,this.quote.price_decs),vol:s,oi:r,msg:"",textColor:""},a=i.last_price-n.last_price,c=0;switch(c=i.last_price>=n.ask_price1?1:i.last_price<=n.bid_price1?-1:a>0?1:a<0?-1:0,o.msg=r>0&&r===s?"双开":r<0&&r+s===0?"双平":0===c?"换手":(c>0?"多":"空")+(r>0?"开":r<0?"平":"换"),o.msg){case"双开":case"双平":o.textColor=1===c?"R":-1===c?"G":"";break;case"多开":case"多换":case"空平":o.textColor="R";break;case"空开":case"空换":case"多平":o.textColor="G";break;default:o.textColor="";break}return o}return null},update:function(t){var e=50,i=0;if(t&&t.last_id>0)if(0===this.ticks.length){this.last_id=t.last_id;for(var n=t.last_id;n>=0;n--){var s=this.genOneTick(n,t);if(null!==s&&(this.$set(this.ticks,i,s),i++,i===e))break}}else if(this.last_id<t.last_id){var r=this.genOneTick(t.last_id,t);null!==r&&r.datetime>this.ticks[0].datetime&&this.ticks.splice(0,0,r)}}}},F=W,B=(i("2b71"),Object(c["a"])(F,A,M,!1,null,"55d7331d",null));B.options.__file="TicksList.vue";var $=B.exports,G=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Split",{staticClass:"split-container",model:{value:t.this_split,callback:function(e){t.this_split=e},expression:"this_split"}},[i("div",{staticClass:"split-pane left",attrs:{slot:"left"},slot:"left"},[t._t("left")],2),i("div",{staticClass:"split-vertical",attrs:{slot:"trigger"},slot:"trigger"},[i("div",{staticClass:"split-vertical-dots"},[i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"}),i("span",{staticClass:"dot"})])]),i("div",{staticClass:"split-pane right",attrs:{slot:"right"},slot:"right"},[t._t("right")],2)])},H=[],Q=(i("c5f6"),i("28a5"),{data:function(){return{this_split:.5}},created:function(){this.this_split=this.split},props:{split:{type:Number}}}),Y=Q,z=(i("966f"),Object(c["a"])(Y,G,H,!1,null,null,null));z.options.__file="SplitLeftRight.vue";var K=z.exports,Z=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"row"},[i("div",t._l(t.tags,function(e,n){return i("div",{key:n,staticClass:"col"},[i("Button",{attrs:{size:"small",type:t.type(e)},on:{click:function(i){t.handlerClickTag(e)}}},[t._v("\n                "+t._s(e)+"\n            ")])],1)}))])},X=[],J={name:"ButtonsLine",data:function(){return{selectedTag:this.defaultTag?this.defaultTag:this.tags[0]}},props:{tags:{type:Array,required:!0,validator:function(t){return t.length>0}},defaultTag:String},methods:{type:function(t){return t===this.selectedTag?"primary":"default"},handlerClickTag:function(t){this.selectedTag=t,this.$emit("change",t)}}},V=J,tt=(i("0894"),Object(c["a"])(V,Z,X,!1,null,"8c7ab0d4",null));tt.options.__file="ButtonsLine.vue";var et=tt.exports,it=i("db49"),nt={name:"quotes",components:{TableQuotes:D,QuoteInfo:q,TicksList:$,SplitLeftRight:K,ButtonsLine:et},data:function(){var t=this.$route.params.tag;return{defaultTag:t,tags:this.$store.state.tags,quotesTableRow:it["d"],rootPath:"quotes/",selectedTab:"quoteInfo"}},computed:Object(p["a"])({quotesList:function(){var t=this.$store.state.tagsQuotesMap[this.$route.params.tag];return t&&this.$store.commit("SUBSCRIBE_QUOTE",t),t},rowWidth:function(){var t=this.$store.state.tags.join("").length,e=this.$store.state.tags.length;return 12.5*t+20*e}},Object(b["b"])({instrumentId:"getSelectedShowInstrumentId"})),methods:{handlerChangeTag:function(t){this.$router.replace({name:"quotes",params:{tag:t}})}}},st=nt,rt=(i("f8fe"),Object(c["a"])(st,m,f,!1,null,"3f50a2c4",null));rt.options.__file="Quotes.vue";var ot=rt.exports,at=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{height:"100%"}},[i("confirm"),0===t.tradingDay.length?i("login"):i("trade")],1)},ct=[],ut=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"user-trade"},[i("SplitLeftRight",{attrs:{split:t.split}},[i("template",{slot:"left"},[i("Form",{attrs:{"label-width":60}},[i("FormItem",{attrs:{label:"合约"}},[i("AutoComplete",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入合约"},on:{"on-search":t.querySearch},model:{value:t.instrumentId,callback:function(e){t.instrumentId=e},expression:"instrumentId"}},[i("div",{staticClass:"auto-complete-search-result"},t._l(t.searchResult,function(e){return i("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])}))])],1),i("FormItem",{attrs:{label:"手数"}},[i("InputNumber",{staticStyle:{width:"200px"},attrs:{min:1},model:{value:t.volume,callback:function(e){t.volume=e},expression:"volume"}})],1),i("FormItem",{attrs:{label:"价格"}},[i("InputNumber",{staticStyle:{width:"200px"},attrs:{max:t.maxPrice,min:t.minPrice,step:t.priceTick},model:{value:t.limitPrice,callback:function(e){t.limitPrice=e},expression:"limitPrice"}})],1),i("FormItem",[i("Button",{on:{click:function(e){t.insertOrder("BUY","OPEN")}}},[t._v("买开")]),i("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){t.insertOrder("SELL","OPEN")}}},[t._v("卖开")])],1),i("FormItem",[i("Button",{on:{click:function(e){t.insertOrder("BUY","CLOSE")}}},[t._v("买平")]),i("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){t.insertOrder("SELL","CLOSE")}}},[t._v("卖平")])],1)],1)],1),i("template",{slot:"right"},[i("Tabs",{attrs:{type:"card",animated:!1},model:{value:t.selectedTab,callback:function(e){t.selectedTab=e},expression:"selectedTab"}},[i("TabPane",{attrs:{label:"账户",name:"accounts"}},[i("table-accounts")],1),i("TabPane",{attrs:{label:"持仓",name:"positions"}},[i("table-positions",{attrs:{height:t.height}})],1),i("TabPane",{attrs:{label:"委托单",name:"orders"}},[i("table-orders",{attrs:{height:t.height}})],1),i("TabPane",{attrs:{label:"成交记录",name:"trades"}},[i("table-trades",{attrs:{height:t.height}})],1)],1)],1)],2)],1)},lt=[],dt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"accounts-container"},[i("Table",{attrs:{columns:t.columns1,data:[t.account]}}),i("Table",{attrs:{columns:t.columns2,data:[t.account]}})],1)},ht=[],_t={data:function(){var t={balance:"账户权益",available:"可用资金",pre_balance:"账户权益",deposit:"入金金额",withdraw:"出金金额",commission:"手续费",premium:"权利金",static_balance:"静态权益",position_profit:"持仓盈亏",float_profit:"浮动盈亏",risk_ratio:"风险度",margin:"占用资金",frozen_margin:"冻结保证金",frozen_commission:"冻结手续费",frozen_premium:"冻结权利金",close_profit:"平仓盈亏"};return{columns1:[{title:t["balance"],key:"balance"},{title:t["available"],key:"available"},{title:t["pre_balance"],key:"pre_balance"},{title:t["deposit"],key:"deposit"},{title:t["withdraw"],key:"withdraw"},{title:t["commission"],key:"commission"}],columns2:[{title:t["static_balance"],key:"static_balance"},{title:t["position_profit"],key:"position_profit"},{title:t["float_profit"],key:"float_profit"},{title:t["close_profit"],key:"close_profit"},{title:t["margin"],key:"margin"},{title:t["risk_ratio"],key:"risk_ratio"}]}},computed:Object(p["a"])({},Object(b["b"])({account:"accounts/GET_ACCOUNT"}))},mt=_t,ft=(i("1f5e"),Object(c["a"])(mt,dt,ht,!1,null,"09b875b1",null));ft.options.__file="TableAccounts.vue";var pt=ft.exports,bt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Table",{attrs:{height:t.height,columns:t.columns,data:t.positions}})},gt=[],vt={data:function(){return{columns:[{title:"合约代码",key:"instrument_id",width:80,fixed:"left"},{title:"最新价",key:"last_price",width:80,align:"right",fixed:"left"},{title:"多仓",key:"volume_long",width:50,align:"right",className:"col-buy"},{title:"开仓均价",key:"open_price_long",width:80,align:"right",className:"col-buy",render:this.formatterPrice},{title:"持仓盈亏",key:"position_profit_long",width:80,align:"right",className:"col-buy",render:this.formatterPrice},{title:"操作",key:"action",width:150,align:"center",className:"col-buy",render:this.genButtons},{title:"空仓",key:"volume_short",width:50,align:"right",className:"col-sell"},{title:"开仓均价",key:"open_price_short",width:80,align:"right",className:"col-sell",render:this.formatterPrice},{title:"持仓盈亏",key:"position_profit_short",width:80,align:"right",className:"col-sell",render:this.formatterPrice},{title:"操作",key:"action",width:150,align:"center",className:"col-sell",render:this.genButtons},{title:"持仓占用",key:"margin",width:80,align:"right",render:this.formatterPrice}]}},props:{height:{type:String},loading:{type:Boolean,default:!1}},mounted:function(){},computed:Object(p["a"])({},Object(b["b"])({positions:"positions/GET_POSITIONS"})),methods:{formatterPrice:function(t,e){return t("div",Object(L["d"])(e.row[e.column.key]))},genButtons:function(t,e){var i=this,n="col-buy"===e.column.className?"success":"error",s="col-buy"===e.column.className?"SELL":"BUY",r="col-buy"===e.column.className?e.row.volume_long:e.row.volume_short,o=[t("Button",{props:{type:n,size:"small"},style:{marginRight:"5px"},on:{click:function(){i.handleClose(e.index,e.row,s)}}},"平仓"),t("Button",{props:{type:n,size:"small"},style:{marginRight:"5px"},on:{click:function(){i.handleCloseOpen(e.index,e.row,s)}}},"反手")];return t("div",r>0?o:[])},handleClose:function(t,e,i){var n=this.$store.getters["quotes/GET_QUOTE"](e.exchange_id+"."+e.instrument_id),s="BUY"===i?e.volume_short:e.volume_long;this.$store.commit("INSERT_ORDER",{symbol:n.instrument_id,exchange_id:n.exchange_id,ins_id:n.ins_id,direction:i,offset:"CLOSE",limitPrice:n.last_price,volume:s})},handleCloseOpen:function(t,e,i){var n=this.$store.getters["quotes/GET_QUOTE"](e.exchange_id+"."+e.instrument_id),s="BUY"===i?e.volume_short:e.volume_long;this.$store.commit("INSERT_ORDER",{symbol:n.instrument_id,exchange_id:n.exchange_id,ins_id:n.ins_id,direction:i,offset:"CLOSE",limitPrice:n.last_price,volume:s}),this.$store.commit("INSERT_ORDER",{symbol:n.instrument_id,exchange_id:n.exchange_id,ins_id:n.ins_id,direction:i,offset:"OPEN",limitPrice:n.last_price,volume:s})},rowClick:function(t,e,i){var n=t.exchange_id+"."+t.instrument_id;this.$store.commit("SET_SELECTED_SYMBOL",n)}}},yt=vt,Et=Object(c["a"])(yt,bt,gt,!1,null,null,null);Et.options.__file="TablePositions.vue";var kt=Et.exports,Tt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Table",{attrs:{height:t.height,columns:t.columns,data:t.orders}})},wt=[],St={data:function(){var t=this;return{columns:[{title:"委托单ID",key:"order_id",width:180,fixed:"left"},{title:"合约代码",key:"instrument_id",width:70,align:"center"},{title:"方向",key:"direction",width:50,align:"center",render:function(t,e){return t("div",Object(L["b"])(e.row.direction))}},{title:"开平",key:"offset",width:50,align:"center",render:function(t,e){return t("div",Object(L["c"])(e.row.offset))}},{title:"手数",key:"volume_orign",width:50,align:"right"},{title:"价格",key:"limit_price",width:70,align:"right"},{title:"未成交",key:"volume_left",width:60,align:"right"},{title:"操作",key:"action",width:80,align:"center",render:function(e,i){var n=e("Button",{props:{size:"small"},style:{marginRight:"5px"},on:{click:function(){t.handleCancelOrder(i.index,i.row)}}},"撤单");return"ALIVE"===i.row.status?e("div",[n]):e("div",[])}},{title:"状态",key:"status",width:100,align:"center",render:function(t,e){return"FINISHED"===e.row.status?t("div","已完成"):t("div","未完成")}},{title:"下单时间",key:"insert_date_time",width:160,align:"right",render:function(t,e){return t("div",Object(L["a"])(e.row.insert_date_time))}},{title:"提示",key:"last_msg",width:180,align:"right"}]}},props:{height:{type:String}},mounted:function(){},computed:Object(p["a"])({},Object(b["b"])({orders:"orders/GET_ORDERS"})),methods:{filterStatus:function(t,e){return e.status===t},handleCancelOrder:function(t,e){this.$store.commit("CANCEL_ORDER",{order_id:e.order_id})},rowClick:function(t,e,i){var n=t.exchange_id+"."+t.instrument_id;this.$store.commit("SET_SELECTED_SYMBOL",n)}}},Ct=St,Ot=Object(c["a"])(Ct,Tt,wt,!1,null,null,null);Ot.options.__file="TableOrders.vue";var Pt=Ot.exports,Dt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Table",{attrs:{height:t.height,columns:t.columns,data:t.trades}})},xt=[],It={data:function(){return{columns:[{title:"委托单ID",key:"order_id",width:180,fixed:"left"},{title:"交易所单号",key:"exchange_trade_id",width:100,align:"left"},{title:"合约代码",key:"instrument_id",width:100,align:"left"},{title:"方向",key:"direction",width:50,align:"center",render:function(t,e){return t("div",Object(L["b"])(e.row.direction))}},{title:"开平",key:"offset",width:50,align:"center",render:function(t,e){return t("div",Object(L["c"])(e.row.offset))}},{title:"手数",key:"volume",width:50,align:"right"},{title:"价格",key:"price",width:70,align:"right",render:function(t,e){return t("div",Object(L["d"])(e.row.price))}},{title:"时间",key:"trade_date_time",width:160,align:"right",render:function(t,e){return t("div",Object(L["a"])(e.row.trade_date_time))}},{title:"手续费",key:"commission",width:80,align:"right"}]}},props:{height:{type:String}},mounted:function(){},computed:Object(p["a"])({},Object(b["b"])({trades:"trades/GET_TRADES",filtersObj:"trades/GET_TRADES_DISTINCT_INSID"})),methods:{filterInstrumentId:function(t,e){return e.instrument_id===t}}},Lt=It,jt=Object(c["a"])(Lt,Dt,xt,!1,null,null,null);jt.options.__file="TableTrades.vue";var Rt=jt.exports,Nt={components:{TableAccounts:pt,TablePositions:kt,TableOrders:Pt,TableTrades:Rt,SplitLeftRight:K},data:function(){return{split:.3,searchResult:[],selectedTab:"accounts",volume:1,priceTick:1,limitPrice:0,priceDecs:0,maxPrice:1/0,minPrice:0}},mounted:function(){var t=this;this.$store.subscribe(function(e,i){if("SET_SELECTED_SYMBOL"===e.type){var n=t.$store.getters["quotes/GET_QUOTE"](e.payload);n&&(t.priceTick=Number(n.price_tick),t.limitPrice=Number(n.last_price),t.priceDecs=Number(n.price_decs),t.maxPrice=0===n.upper_limit?1/0:Number(n.upper_limit),t.minPrice=0===n.lower_limit?0:Number(n.lower_limit))}})},computed:Object(p["a"])({height:function(){return this.$root.windowHeight*(1-this.$root.appSplit)-44+""},instrumentId:{get:function(){return this.innerInstrumentId},set:function(t){this.$store.commit("SET_SELECTED_SYMBOL",t)}}},Object(b["b"])({innerInstrumentId:"getSelectedInstrumentId"})),methods:{querySearch:function(t,e){var i=t?this.$store.getters["quotes/GET_QUOTES_BY_INPUT"](t):[];this.searchResult=i},handleSelectInstrument:function(t){},insertOrder:function(t,e){var i=this.$store.getters["quotes/GET_QUOTE"](this.instrumentId);this.$store.commit("INSERT_ORDER",{symbol:i.instrument_id,exchange_id:i.exchange_id,ins_id:i.ins_id,direction:t,offset:e,limitPrice:this.limitPrice,volume:this.volume})}}},qt=Nt,At=(i("e86d"),Object(c["a"])(qt,ut,lt,!1,null,null,null));At.options.__file="UserTrade.vue";var Mt=At.exports,Ut=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"user-login"},[t.showLoginError?i("Alert",{attrs:{type:"error","show-icon":"",closable:""}},[t._v("\n        等待回应超时,可能的原因 (1)服务器正在运维，(2)网络不通，无法连接服务器，请稍后/检查网络后重试。\n    ")]):t._e(),i("Form",{ref:"userForm",attrs:{model:t.userForm,rules:t.rules,"label-width":80}},[i("FormItem",{attrs:{label:"期货公司",prop:"bid"}},[i("Select",{model:{value:t.userForm.bid,callback:function(e){t.$set(t.userForm,"bid",e)},expression:"userForm.bid"}},t._l(t.brokers,function(e){return i("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])}))],1),i("FormItem",{attrs:{label:"账号",prop:"user_name"}},[i("Input",{attrs:{placeholder:"请输入账号"},model:{value:t.userForm.user_name,callback:function(e){t.$set(t.userForm,"user_name",e)},expression:"userForm.user_name"}})],1),i("FormItem",{attrs:{label:"密码",prop:"password"}},[i("Input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:t.userForm.password,callback:function(e){t.$set(t.userForm,"password",e)},expression:"userForm.password"}})],1),i("FormItem",[i("Button",{attrs:{loading:t.loading,type:"primary"},on:{click:function(e){t.onSubmit("userForm")}}},[t._v("\n                登录\n            ")])],1)],1)],1)},Wt=[],Ft=(i("f751"),{name:"userLogin",data:function(){return{userForm:Object.assign({bid:"",user_name:"",password:""},it["a"]),rules:{bid:[{required:!0,message:"请选择期货公司",trigger:"blur"}],user_name:[{required:!0,message:"请输入账户",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},loading:!1,showLoginError:!1}},computed:Object(p["a"])({},Object(b["b"])({brokers:"getBrokers"})),methods:{onSubmit:function(t){var e=this;this.loading=!0,this.$refs[t].validate(function(t){t&&(e.$store.commit("LOGIN",{bid:e.userForm.bid,user_name:e.userForm.user_name,password:e.userForm.password}),setTimeout(function(){0===this.$store.state.trading_day.length&&(this.loading=!1,this.showLoginError=!0)}.bind(e),1e4))})}}}),Bt=Ft,$t=(i("55b5"),Object(c["a"])(Bt,Ut,Wt,!1,null,null,null));$t.options.__file="UserLogin.vue";var Gt=$t.exports,Ht=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Modal",{attrs:{title:"确认结算单",closable:!1,"mask-closable":!1},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[i("div",{staticClass:"confirm-container"},[i("pre",[t._v(t._s(t.confirmContent))])]),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"primary"},on:{click:t.clickOk}},[t._v("确定")])],1)])},Qt=[],Yt={props:{},computed:{visible:function(){return"doing"===this.$store.state.confirm},confirmContent:function(){return this.$store.state.confirmContent}},methods:{clickOk:function(){this.$store.commit("CONFIRM_SETTLEMENT")}}},zt=Yt,Kt=(i("d860"),Object(c["a"])(zt,Ht,Qt,!1,null,"8486de14",null));Kt.options.__file="UserConfirmSettlement.vue";var Zt=Kt.exports,Xt={name:"user",data:function(){return{}},components:{Trade:Mt,Login:Gt,Confirm:Zt},computed:{tradingDay:function(){return this.$store.state.trading_day}}},Jt=Xt,Vt=Object(c["a"])(Jt,at,ct,!1,null,null,null);Vt.options.__file="User.vue";var te=Vt.exports,ee=(i("6923"),[{id:"主连",func:function(t){return"FUTURE_CONT"===t.class}},{id:"指数",func:function(t){return"FUTURE_INDEX"===t.class}},{id:"金融",func:function(t){return["IH","IF","IC","T","TF"].includes(t.product_id)||["CFFEX.IH","CFFEX.IF","CFFEX.IC","CFFEX.T","CFFEX.TF"].includes(t.underlying_product)}},{id:"金银",func:function(t){return["au","ag"].includes(t.product_id)||["SHFE.au","SHFE.ag"].includes(t.underlying_product)}},{id:"铜铝铅锌",func:function(t){return["al","cu","ni","pb","sn","zn"].includes(t.product_id)||["SHFE.al","SHFE.cu","SHFE.ni","SHFE.pb","SHFE.sn","SHFE.zn"].includes(t.underlying_product)}},{id:"双焦",func:function(t){return["j","jm"].includes(t.product_id)||["DCE.j","DCE.jm"].includes(t.underlying_product)}},{id:"钢铁",func:function(t){return["SF","SM","hc","i","rb"].includes(t.product_id)||["CZCE.SF","CZCE.SM","SHFE.hc","DCE.i","SHFE.rb"].includes(t.underlying_product)}},{id:"煤炭",func:function(t){return["ZC","j","jm"].includes(t.product_id)||["CZCE.ZC","DCE.j","DCE.jm"].includes(t.underlying_product)}},{id:"化工",func:function(t){return["MA","TA","bu","l","pp","ru","v"].includes(t.product_id)||["CZCE.MA","CZCE.TA","SHFE.bu","DCE.l","DCE.pp","SHFE.ru","DCE.v"].includes(t.underlying_product)}},{id:"油脂",func:function(t){return["OI","p","y"].includes(t.product_id)||["CZCE.OI","DCE.p","DCE.y"].includes(t.underlying_product)}},{id:"软商品",func:function(t){return["CF","CY","SR"].includes(t.product_id)||["CZCE.CF","CZCE.CY","CZCE.SR"].includes(t.underlying_product)}},{id:"谷物",func:function(t){return["JR","LR","RI","WH","a","c"].includes(t.product_id)||["CZCE.JR","CZCE.LR","CZCE.RI","CZCE.WH","DCE.a","DCE.c"].includes(t.underlying_product)}},{id:"农副",func:function(t){return["cs","jd"].includes(t.product_id)||["DCE.cs","DCE.jd"].includes(t.underlying_product)}},{id:"饲料",func:function(t){return["RM","c","m"].includes(t.product_id)||["CZCE.RM","DCE.c","DCE.m"].includes(t.underlying_product)}},{id:"建材",func:function(t){return["FG","rb"].includes(t.product_id)||["CZCE.FG","SHFE.rb"].includes(t.underlying_product)}}]),ie={};for(var ne in ee)ie[ee[ne].id]=[];var se=ee,re=(i("ac6a"),i("456d"),i("55dd"),{SET_WS_CONNECT_STATUS:function(t,e){Object.assign(t,e)},SET_SELECTED_SYMBOL:function(t,e){t.selectSymbol=e},SET_SELECTED_SHOW_SYMBOL:function(t,e){t.selectShowSymbol=e},SET_TAGS_QOUTES_MAP:function(t,e){var i={};for(var n in e){var s=e[n];for(var r in se){var o=se[r];o.func(s)&&(i[o.id]?i[o.id].push(n):i[o.id]=[n])}}for(var a in i)i[a].sort(function(t,i){var n=e[t].sort_key-e[i].sort_key;return 0===n?e[t].ins_id-e[i].ins_id:n});t.tagsQuotesMap=i},MERGE_QUOTE_WS_DATA:function(t,e){for(var i in e)switch(i){case"ins_list":t.ins_list=e["ins_list"].split(",").filter(function(t){return t.length>0});break;case"quotes":we.commit("quotes/UPDATE_QUOTES",e["quotes"]);break;default:break}},MERGE_TRADE_WS_DATA:function(t,e){if(e["notify"])for(var i in e["notify"]){var s=e["notify"][i];"SETTLEMENT"===s.type?(t.confirm="doing",t.confirmContent=s["content"]):"MESSAGE"===s.type?n["default"].prototype.$Message.info(s.content):n["default"].prototype.$Message.error(s.content)}if(e["trade"]&&e["trade"][t.user_id]){var r=e["trade"][t.user_id];for(var o in r)if(0!==Object.keys(r[o]).length)switch(o){case"session":t.trading_day=r["session"]["trading_day"];break;case"accounts":we.commit("accounts/UPDATE_ACCOUNTS",r["accounts"]);break;case"trades":we.commit("trades/UPDATE_TRADES",r["trades"]);break;case"positions":we.commit("positions/UPDATE_POSITIONS",r["positions"]);break;case"orders":we.commit("orders/UPDATE_ORDERS",r["orders"]);break;case"transfers":we.commit("transfers/UPDATE_TRANSFERS",r["transfers"]);break;case"banks":we.commit("banks/UPDATE_BANKS",r["banks"]);break}}},SET_BROKERS:function(t,e){t.brokers=e},SUBSCRIBE_QUOTE:function(t,e){var i=t.positions.PositionsSymbolsList,n=e.concat(i);n.length>0&&U["b"].send({aid:"subscribe_quote",ins_list:n.join(",")})},SET_TICK_CHART:function(t,e){U["b"].send({aid:"set_chart",chart_id:"web_tick_chart",ins_list:e.ins_list?e.ins_list.join(","):e.symbol,duration:0,view_width:e.view_width?e.view_width:100})},SET_CHART:function(t,e){var i={};e.trading_day_start||e.trading_day_count?(i.trading_day_start=e.trading_day_start?e.trading_day_start:0,i.trading_day_count=e.trading_day_count?e.trading_day_count:864e11):(i.view_width=e.view_width?e.view_width:500,e.left_kline_id?i.left_kline_id=e.left_kline_id:e.focus_datetime&&(i.focus_datetime=e.focus_datetime,i.focus_position=e.focus_position?e.focus_position:0)),U["b"].send(Object.assign({aid:"set_chart",chart_id:"web_kline_chart",ins_list:e.ins_list?e.ins_list.join(","):e.symbol,duration:e.duration},i))},LOGIN:function(t,e){t.bid=e.bid,t.user_id=e.user_name,U["c"].send({aid:"req_login",bid:e.bid,user_name:e.user_name,password:e.password})},CONFIRM_SETTLEMENT:function(t,e){t.confirm="done",U["c"].send({aid:"confirm_settlement"})},INSERT_ORDER:function(t,e){var i={aid:"insert_order",user_id:t.user_id,price_type:"LIMIT",volume_condition:"ANY",time_condition:"GFD",exchange_id:e.exchange_id,instrument_id:e.ins_id,direction:e.direction,limit_price:e.limitPrice};if("SHFE"===e.exchange_id&&"CLOSE"===e.offset){var n=we.getters["positions/GET_POSITION"](e.symbol),s=0;"BUY"===e.direction&&n.volume_short_today>0?s=Math.min(n.volume_short_today,e.volume):"SELL"===e.direction&&n.volume_long_today>0&&(s=Math.min(n.volume_long_today,e.volume)),s>0&&U["c"].send(Object.assign({order_id:"TQWEB."+Object(L["e"])(8),offset:"CLOSETODAY",volume:s},i)),e.volume-s>0&&U["c"].send(Object.assign({order_id:"TQWEB."+Object(L["e"])(8),offset:"CLOSE",volume:e.volume-s},i))}else U["c"].send(Object.assign({order_id:"TQWEB."+Object(L["e"])(8),offset:e.offset,volume:e.volume},i))},CANCEL_ORDER:function(t,e){U["c"].send({aid:"cancel_order",user_id:t.user_id,order_id:e.order_id})},TRANSFER:function(t,e){U["c"].send({aid:"req_transfer"})}}),oe={getBrokers:function(t){return t.brokers},getSelectedInstrumentId:function(t,e){return t.selectSymbol},getSelectedShowInstrumentId:function(t,e){return t.selectShowSymbol}},ae={init:function(t){var e=t.commit;fetch(it["b"],{headers:{Accept:"application/json; charset=utf-8"}}).then(function(t){return t.json()}).then(function(t){for(var i in n["default"].prototype.$Message.success("获取合约列表。"),t)(t[i].expired||"FUTURE_OPTION"===t[i].class)&&delete t[i];e("quotes/INIT_QUOTES",t),e("SET_TAGS_QOUTES_MAP",t)}).catch(function(t){console.log("Fetch Error :-S",t),n["default"].prototype.$Message.error("获取合约列表失败，请检查网络后刷新页面。")})}},ce=function(t){return{namespaced:!0,state:function(){return Object.assign({},t)},mutations:{UPDATE:function(t,e){return Object.assign(t,e)}}}},ue=ce({balance:"账户权益",available:"可用资金",pre_balance:"账户权益",deposit:"入金金额",withdraw:"出金金额",commission:"手续费",premium:"权利金",static_balance:"静态权益",position_profit:"持仓盈亏",float_profit:"浮动盈亏",risk_ratio:"风险度",margin:"占用资金",frozen_margin:"冻结保证金",frozen_commission:"冻结手续费",frozen_premium:"冻结权利金",close_profit:"平仓盈亏"}),le={namespaced:!0,state:{AccountsList:[]},mutations:{UPDATE_ACCOUNTS:function(t,e){for(var i in e)t[i]||we.registerModule(["accounts",i],ue),we.commit("accounts/"+i+"/UPDATE",e[i])}},getters:{GET_ACCOUNT:function(t){var e={};for(var i in t.CNY){var n=t.CNY[i];"risk_ratio"===i?n=(100*n).toFixed(2)+"%":"number"===typeof n&&n%1!==0&&(n=n.toFixed(2)),e[i]=n}return e},GET_ACCOUNTS:function(t){return t.AccountsList}}},de=ce({user_id:"",exchange_id:"",instrument_id:"",volume_long_today:0,volume_long_his:0,volume_long:0,volume_long_frozen_today:0,volume_long_frozen_his:0,volume_short_today:0,volume_short_his:0,volume_short:0,volume_short_frozen_today:0,volume_short_frozen_his:0,open_price_long:0,open_price_short:0,open_cost_long:0,open_cost_short:0,position_price_long:0,position_price_short:0,position_cost_long:0,position_cost_short:0,last_price:0,float_profit_long:0,float_profit_short:0,float_profit:0,position_profit_long:0,position_profit_short:0,position_profit:0,margin_long:0,margin_short:0,margin:0}),he={namespaced:!0,state:{PositionsList:[],PositionsSymbolsList:[]},mutations:{UPDATE_POSITIONS:function(t,e){for(var i in e)t[i]||(we.registerModule(["positions",i],de),t.PositionsList.push(i)),we.commit("positions/"+i+"/UPDATE",e[i]);for(var n=0;n<t.PositionsList.length;n++){var s=t[t.PositionsList[n]].exchange_id+"."+t[t.PositionsList[n]].instrument_id;t.PositionsSymbolsList.includes(s)||t.PositionsSymbolsList.push(s)}}},getters:{GET_POSITION:function(t){return function(e){return t[e]}},GET_POSITIONS:function(t){for(var e=[],i=0;i<t.PositionsList.length;i++)(t[t.PositionsList[i]].volume_long>0||t[t.PositionsList[i]].volume_short>0)&&e.push(t[t.PositionsList[i]]);return e}}},_e=he,me=ce({user_id:"",order_id:"",exchange_id:"",instrument_id:"",direction:"",offset:"",volume_orign:0,price_type:"",limit_price:0,time_condition:"",volume_condition:"",insert_date_time:0,exchange_order_id:"",status:"",volume_left:0,frozen_margin:0,last_msg:"",seqno:0}),fe={namespaced:!0,state:{OrdersList:[]},mutations:{UPDATE_ORDERS:function(t,e){for(var i in e)t[i]||(we.registerModule(["orders",i],me),t.OrdersList.push(i)),we.commit("orders/"+i+"/UPDATE",e[i])}},actions:{},getters:{GET_ORDERS:function(t){for(var e=[],i=0;i<t.OrdersList.length;i++)e.push(t[t.OrdersList[i]]);return e}}},pe=(i("5df3"),i("4f7f"),ce({user_id:"",order_id:"",trade_id:"",exchange_id:"",instrument_id:"",exchange_trade_id:"",direction:"",offset:"",volume:0,price:0,trade_date_time:0,commission:0,seqno:0})),be={namespaced:!0,state:{TradesList:[]},mutations:{UPDATE_TRADES:function(t,e){for(var i in e)t[i]||(we.registerModule(["trades",i],pe),t.TradesList.push(i)),we.commit("trades/"+i+"/UPDATE",e[i])}},getters:{GET_TRADES:function(t){for(var e=[],i=0;i<t.TradesList.length;i++)e.push(t[t.TradesList[i]]);return e},GET_TRADES_DISTINCT_INSID:function(t){for(var e=[],i=new Set,n=0;n<t.TradesList.length;n++){var s=t[t.TradesList[n]].instrument_id;i.add(s)}return i.forEach(function(t,i,n){e.push({text:t,value:t})}),e}}},ge=(ce({datetime:0,currency:"",amount:0,error_id:0,error_msg:""}),{namespaced:!0,state:{TransfersList:[]},mutations:{UPDATE_TRANSFERS:function(t,e){for(var i in e)t[i]||we.registerModule(["transfers",i],Trade),we.commit("transfers/"+i+"/UPDATE",e[i]),t.TransfersList.includes(t[i])||t.TransfersList.push(t[i])}},actions:{},getters:{GET_TRANSFERS:function(t){return t.TransfersList}}}),ve=ce({id:"",name:""}),ye={namespaced:!0,state:{BanksList:[]},mutations:{UPDATE_BANKS:function(t,e){for(var i in e)if(t[i]||we.registerModule(["banks",i],ve),null===e[i]){var n=t.BanksList.indexOf(t[i]);n>-1&&t.BanksList.splice(n,1),we.unregisterModule(["banks",i])}else we.commit("banks/"+i+"/UPDATE",e[i]),t.BanksList.includes(t[i])&&t.BanksList.push(t[i])}},getters:{GET_POSITIONS:function(t){return t.BanksList}}},Ee=Object.assign({instrument_id:"",class:"",ins_id:"",ins_name:"",exchange_id:"",sort_key:"",expired:!1,py:"",product_id:"",product_short_name:"",underlying_product:"",underlying_symbol:"",delivery_year:0,delivery_month:0,expire_datetime:0,trading_time:{},volume_multiple:0,price_tick:0,price_decs:0},{max_market_order_volume:1e3,min_market_order_volume:1,max_limit_order_volume:1e3,min_limit_order_volume:1,margin:"-",commission:"-",datetime:"",ask_price1:"-",ask_volume1:"-",bid_price1:"-",bid_volume1:"-",last_price:"-",change:"-",highest:"-",lowest:"-",lower_limit:"-",upper_limit:"-",open:"-",close:"-",amount:"-",volume:"-",open_interest:"-",settlement:"-",average:"-",pre_open_interest:"-",pre_close:"-",pre_volume:"-",pre_settlement:"-"}),ke=ce(Ee),Te={namespaced:!0,state:{SymbolsList:[]},mutations:{INIT_QUOTES:function(t,e){for(var i in e)we.registerModule(["quotes",i],ke),we.commit("quotes/"+i+"/UPDATE",e[i]),"FUTURE"===e[i].class&&t.SymbolsList.push(i)},UPDATE_QUOTES:function(t,e){for(var i in e)t[i]||we.registerModule(["quotes",i],ke),null!==e[i]&&we.commit("quotes/"+i+"/UPDATE",e[i]),t[i].change=t[i].last_price-t[i].pre_settlement,isNaN(t[i].change)&&(t[i].change="-")}},getters:{GET_QUOTE:function(t){return function(e){return t[e]}},GET_QUOTE_FIELD:function(t){return function(e,i){return t[e][i]}},GET_QUOTES_BY_LIST:function(t){return function(e){return e.map(function(e){return t[e]})}},GET_QUOTES_BY_INPUT:function(t){return function(e){var i=[];for(var n in e=e.toLowerCase(),t.SymbolsList){var s=t[t.SymbolsList[n]];(s.instrument_id.toLowerCase().includes(e)||s.ins_name.toLowerCase().includes(e))&&i.push(s.instrument_id)}if(i.length>0)return i;for(var r in t.SymbolsList){var o=t[t.SymbolsList[r]];o.py.includes(e)&&i.push(o.instrument_id)}return i}}}};n["default"].use(b["a"]);var we=new b["a"].Store({plugins:[U["d"]],modules:{quotes:Te,accounts:le,positions:_e,orders:fe,trades:be,transfers:ge,banks:ye},state:{brokers:[],bid:"",user_id:"",trading_day:"",confirm:"done",confirmContent:"",selectShowSymbol:"KQ.m@CFFEX.IF",selectSymbol:"",quoteWsConnected:!1,tradeWsConnected:!1,ins_list:[],tags:se.map(function(t){return t.id}),tagsQuotesMap:ie},mutations:re,getters:oe,actions:ae});n["default"].config.productionTip=!1,n["default"].use(_["a"]);var Se=new _["a"]({routes:[{path:"/quotes/:tag",name:"quotes",components:{quotes:ot,user:te}},{path:"/charts/:instrument_id",name:"charts",components:{quotes:function(){return Promise.resolve().then(i.bind(null,"6923"))},user:te}},{path:"/*",redirect:"/quotes/"+se[0].id}]});we.dispatch("init");var Ce={name:"tianqin-web",windowHeight:window.innerHeight,windowWidth:window.innerWidth,appSplit:.6};new n["default"]({data:Ce,router:Se,store:we,render:function(t){return t(l)},beforeCreate:function(){return console.log("beforeCreate")},created:function(){var t;function e(){t||(t=setTimeout(function(){t=null,i()},66))}function i(){Ce.windowHeight=window.innerHeight,Ce.windowWidth=window.innerWidth}window.addEventListener("resize",e,!1)},beforeMount:function(){return console.log("beforeMount")},mounted:function(){return console.log("mounted")},beforeDestroy:function(){return console.log("beforeDestroy")},destroyed:function(){return console.log("destroyed")}}).$mount("#app")},"5c0b":function(t,e,i){"use strict";var n=i("5e27"),s=i.n(n);s.a},"5e27":function(t,e,i){},6923:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"charts-container"},[i("Chart",{attrs:{instrumentId:t.instrumentId,height:t.height}})],1)},s=[],r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"chart",style:{height:t.height+"px"}},[i("RadioGroup",{attrs:{size:"small",type:"button"},on:{"on-change":t.handlerChangePeriod},model:{value:t.selectedPeriod,callback:function(e){t.selectedPeriod=e},expression:"selectedPeriod"}},t._l(t.periods,function(e){return i("Radio",{key:e,attrs:{label:e}},[t._v("\n            "+t._s(e)+"\n        ")])})),i("div",{ref:"CHART",style:{height:t.height-30+"px"},attrs:{id:"CHART"}})],1)},o=[],a=(i("c5f6"),i("ac6a"),i("456d"),i("5698")),c=i("4da7"),u=(i("673e"),i("d4ec")),l=i("bee2"),d=i("ade3"),h=i("99de"),_=i("7e84"),m=i("262e"),f=i("257e"),p=i("0be0"),b=function(t){function e(t){var i;return Object(u["a"])(this,e),i=Object(h["a"])(this,Object(_["a"])(e).call(this)),i.dm=t.dm,i.ws=t.ws,i._symbol=t.symbol?t.symbol:null,i._duration=t.duration?t.duration:null,i._barNumbers=100,i._left_kline_id=null,i.klinesPath&&i.dm.subscribe(i.klinesPath,i.update.bind(Object(f["a"])(Object(f["a"])(i)))),i.sendToServer(),i}return Object(m["a"])(e,t),Object(l["a"])(e,[{key:"update",value:function(){this.klines.last_id&&this.right_id>=this.klines.last_id&&this.fire("update")}},{key:"moves",value:function(t){var e=(this.left_kline_id?this.left_kline_id:this.left_id)-t,i=e+this.view_width-1,n=this.klines.last_id;return e>=0&&e<=n&&(this.left_kline_id=i===this.last_id?null:e,!0)}},{key:"sendToServer",value:function(){this.symbol&&this.duration&&(this.left_kline_id?this.ws.send({aid:"set_chart",chart_id:"web_kline_chart",ins_list:this.symbol,duration:this.duration,view_width:this.view_width,left_kline_id:this.left_kline_id}):this.ws.send({aid:"set_chart",chart_id:"web_kline_chart",ins_list:this.symbol,duration:this.duration,view_width:this.view_width}))}},{key:"view_width",get:function(){return this._barNumbers},set:function(t){this._barNumbers!==t&&(this._barNumbers=t,this.sendToServer())}},{key:"symbol",get:function(){return this._symbol},set:function(t){this._symbol!==t&&(this.klinesPath&&this.dm.unsubscribe(this.klinesPath,this.update),this._symbol=t,this._left_kline_id=null,this.klinesPath&&this.dm.subscribe(this.klinesPath,this.update.bind(this)),this.sendToServer())}},{key:"duration",get:function(){return this._duration},set:function(t){this._duration!==t&&(this.klinesPath&&this.dm.unsubscribe(this.klinesPath,this.update),this._duration=t,this._left_kline_id=null,this.klinesPath&&this.dm.subscribe(this.klinesPath,this.update.bind(this)),this.sendToServer())}},{key:"left_kline_id",get:function(){return this._left_kline_id},set:function(t){this._left_kline_id=t,this.sendToServer()}},{key:"klinesPath",get:function(){return this.symbol&&this.duration?"klines/"+this.symbol+"/"+this.duration:""}},{key:"ticksPath",get:function(){return this.symbol&&0===this.duration?"ticks/"+this.symbol:""}},{key:"quote",get:function(){return this.symbol?this.dm.getByPath("quotes/"+this.symbol):null}},{key:"chart",get:function(){return this.dm.getByPath("charts/"+e.CHART_ID)}},{key:"klines",get:function(){return this.klinesPath?this.dm.getByPath(this.klinesPath):null}},{key:"ticks",get:function(){return this.ticksPath?this.dm.getByPath(this.ticksPath):null}},{key:"left_id",get:function(){return this.chart&&this.chart.state&&this.chart.state.duration===this._duration&&this.chart.state.ins_list===this._symbol&&this.chart.left_id?this.chart.left_id:-1}},{key:"right_id",get:function(){return this.chart&&this.chart.state&&this.chart.state.duration===this._duration&&this.chart.state.ins_list===this._symbol&&this.chart.right_id?this.chart.right_id:-1}}]),e}(p["a"]);Object(d["a"])(b,"CHART_ID","web_kline_chart");i("28a5"),i("7f7f"),i("cadf"),i("551c"),i("097d");var g=function(){return{up:function(t){return t.open<t.close},down:function(t){return t.open>t.close},equal:function(t){return t.open===t.close}}},v=g(),y=function(){function t(e){Object(u["a"])(this,t),this.name=e.name?e.name:(new Date).getTime(),this.plot=e.plot?e.plot:null,this.types=["line","body"]}return Object(l["a"])(t,[{key:"createPaths",value:function(){var t=this;return this.paths=[],Object.keys(v).forEach(function(e){return t.paths.push([t.name,"line",e].join("."))}),Object.keys(v).forEach(function(e){return t.paths.push([t.name,"body",e].join("."))}),this.paths}},{key:"calcPaths",value:function(t,e,i){var n=this;if(this.plot.yScale&&this.plot.xScale&&this.plot.barWidth&&this.plot.barPadding){var s={};this.paths.forEach(function(t){return s[t]=""});for(var r=function(t){Object.keys(v).forEach(function(e){v[e](i[t])&&(s[[n.name,"body",e].join(".")]+=n.bodyPath(i[t],t),s[[n.name,"line",e].join(".")]+=n.linePath(i[t],t))})},o=t;o<=e&&i[o];o++)r(o);return s}}},{key:"bodyPath",value:function(t,e){var i=this.plot.yScale(t.open),n=this.plot.yScale(t.close),s=this.plot.xScale(e)+this.plot.barPadding,r=this.plot.barWidth-2*this.plot.barPadding,o="M ".concat(s," ").concat(i," l ").concat(r," ",0);return i!==n&&(o+=" L ".concat(s+r," ").concat(n," l ").concat(-r," ",0," L ").concat(s," ").concat(i)),o}},{key:"linePath",value:function(t,e){var i=this.plot.yScale(t.high),n=this.plot.yScale(t.low),s=this.plot.xScale(e)+this.plot.barWidth/2,r="M ".concat(s," ").concat(i," L ").concat(s," ").concat(n);return r}}]),t}(),E=y,k=function(){return{up:function(t){return t.open<=t.close},down:function(t){return t.open>t.close}}},T=k(),w=function(){function t(e){Object(u["a"])(this,t),this.name=e.name?e.name:(new Date).getTime(),this.plot=e.plot?e.plot:null}return Object(l["a"])(t,[{key:"createPaths",value:function(){var t=this;return this.paths=[],Object.keys(T).forEach(function(e){return t.paths.push([t.name,"body",e].join("."))}),this.paths}},{key:"calcPaths",value:function(t,e,i){var n=this;if(this.plot.yScale&&this.plot.xScale&&this.plot.barWidth&&this.plot.barPadding){var s={};this.paths.forEach(function(t){return s[t]=""});for(var r=function(t){Object.keys(T).forEach(function(e){T[e](i[t])&&(s[[n.name,"body",e].join(".")]+=n.bodyPath(i[t],t))})},o=t;o<=e&&i[o];o++)r(o);return s}}},{key:"bodyPath",value:function(t,e){var i=this.plot.yScale(0),n=i-this.plot.yScale(t.volume),s=this.plot.xScale(e)+this.plot.barPadding,r=this.plot.barWidth-2*this.plot.barPadding,o="M ".concat(s," ").concat(i," l ").concat(r," ",0," l ",0," ").concat(-n," l ").concat(-r," ",0," l ",0," ").concat(n);return o}}]),t}(),S=w,C=function(){function t(e){Object(u["a"])(this,t),this.name=e.name?e.name:(new Date).getTime(),this.plot=e.plot?e.plot:null}return Object(l["a"])(t,[{key:"createPaths",value:function(){return this.paths=["oi"],this.paths}},{key:"calcPaths",value:function(t,e,i){if(this.plot.yScale&&this.plot.xScale&&this.plot.barWidth&&this.plot.barPadding){for(var n="",s=t;s<=e&&i[s];s++){var r=this.plot.yScale(i[s].close_oi),o=this.plot.xScale(s)+this.plot.barWidth/2;n+=s===t?"M":"L",n+="".concat(o," ").concat(r," ")}return{oi:n}}}}]),t}(),O=C,P=function(){function t(e){var i=this;switch(Object(u["a"])(this,t),this.top=e.top,this.name=e.name,this.type=e.type,this.xScale=e.xScale,this.yScale=a["scaleLinear"]().range([1,0]),"right"===e.yAxisPos?this.yAxis=a["axisRight"]().scale(this.yScale):this.yAxis=a["axisLeft"]().scale(this.yScale),this.barWidth=e.barWidth,this.barPadding=e.barPadding,this.width=e.width,this.height=e.height,this.parentG=e.parentG,this.g=this.parentG.append("g").attr("class",this.name).attr("transform","translate(0,"+this.top+")"),this.g.append("g").attr("class","y axis"),"right"===e.yAxisPos&&this.g.select("g.y.axis").attr("transform","translate("+e.width+",0)"),this.chartDm=e.chartDm,this.type){case"candle":this.path=new E({name:this.name,plot:this});break;case"volume":this.path=new S({name:this.name,plot:this});break;case"oi":this.path=new O({name:this.name,plot:this});break}this.path.createPaths().forEach(function(t){i.appendPlotTypePath(t.split("."))})}return Object(l["a"])(t,[{key:"appendPathsGroupBy",value:function(t){var e=this;Object.keys(t).forEach(function(t){e.appendPlotTypePath([e.name,t])})}},{key:"appendPlotTypePath",value:function(e){this.g.selectAll("path.".concat(t.ArrayJoin(e,"."))).data(function(t){return[t]}).enter().append("path").attr("class","".concat(t.ArrayJoin(e," ")))}},{key:"getYPriceRange",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=1/0,s=-1/0;if(i){for(var r=0,o=t;o<=e;o++){var a=this.chartDm.klines.data[o];r=Math.max(Math.abs(a.high-i),Math.abs(a.low-i),r)}n=i-r,s=i+r}else{for(var c=t;c<=e;c++){var u=this.chartDm.klines.data[c];u&&(n=Math.min(n,u.low),s=Math.max(s,u.high))}if(this.chartDm.quote&&this.chartDm.quote.price_tick){var l=5*this.chartDm.quote.price_tick;n-=l,s+=l}}return[n,s]}},{key:"getYMaxRange",value:function(t,e,i){for(var n=-1/0,s=t;s<=e;s++){var r=this.chartDm.klines.data[s];r&&(n=Math.max(n,r[i]))}return n}},{key:"getYMinRange",value:function(t,e,i){for(var n=1/0,s=t;s<=e;s++){var r=this.chartDm.klines.data[s];r&&(n=Math.min(n,r[i]))}return n}},{key:"draw",value:function(){var t=null;switch(this.type){case"candle":t=this.getYPriceRange(this.chartDm.left_id,this.chartDm.right_id);break;case"volume":t=[0,this.getYMaxRange(this.chartDm.left_id,this.chartDm.right_id,"volume")];break;case"oi":t=[this.getYMinRange(this.chartDm.left_id,this.chartDm.right_id,"close_oi"),this.getYMaxRange(this.chartDm.left_id,this.chartDm.right_id,"close_oi")];break}this.yScale.domain(t),this.g.selectAll("g.y.axis").call(this.yAxis);var e=this.path.calcPaths(this.chartDm.left_id,this.chartDm.right_id,this.chartDm.klines.data);for(var i in e)this.g.select("path.".concat(i)).attr("d",e[i])}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this.yScale.range([t,0])}},{key:"width",get:function(){return this._Width},set:function(t){this._Width=t}},{key:"barWidth",get:function(){return this._barWidth},set:function(t){this._barWidth=t}},{key:"barPadding",get:function(){return this._barPadding},set:function(t){this._barPadding=t}}],[{key:"ArrayJoin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.length?t.join(e):""}},{key:"UpDownEqual",value:function(){return{up:function(t){return t.open<t.close},down:function(t){return t.open>t.close},equal:function(t){return t.open===t.close}}}}]),t}(),D=P,x=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return t.append("g").attr("transform","translate("+e+","+i+")").attr("class",n)},I=a["timeFormat"](".%L"),L=a["timeFormat"](":%S"),j=a["timeFormat"]("%H:%M"),R=a["timeFormat"]("%H:%M"),N=a["timeFormat"]("%m%d"),q=a["timeFormat"]("%m%d"),A=a["timeFormat"]("%y");function M(t){return(a["timeSecond"](t)<t?I:a["timeMinute"](t)<t?L:a["timeHour"](t)<t?j:a["timeDay"](t)<t?R:a["timeMonth"](t)<t?N:a["timeYear"](t)<t?q:A)(t)}var U=function(){function t(e,i){Object(u["a"])(this,t),this._height=i,this._plotsNumber=e||2,this.positions=[],this.initLayout()}return Object(l["a"])(t,[{key:"initLayout",value:function(){var e=1/this.plotsNumber,i=e+.3*e*(this.plotsNumber-1),n=.7*e,s=this.height-t.PLOT_PADDING*(this.plotsNumber-1);this.positions[0]={height:s*i,top:0};for(var r=1;r<this.plotsNumber;r++)this.positions[r]={height:s*n,top:this.positions[r-1].top+this.positions[r-1].height+t.PLOT_PADDING}}},{key:"height",set:function(t){this._height=t,this.initLayout()},get:function(){return this._height}},{key:"plotsNumber",set:function(t){this._plotsNumber=t,this.initLayout()},get:function(){return this._plotsNumber}}]),t}();Object(d["a"])(U,"PLOT_PADDING",2);var W=function(){function t(e){Object(u["a"])(this,t),this.chartDm=new b({dm:e.dm,ws:e.ws,symbol:e.instrumentId,duration:e.duration}),this.chartDm.addEventListener("update",this.draw.bind(this)),this.divDomId=e.id,this.outerWidth=e.width,this.outerHeight=e.height,this.margin=e.margin?e.margin:{top:10,right:50,bottom:30,left:50},this.innerWidth=this.outerWidth-this.margin.left-this.margin.right,this.innerHeight=this.outerHeight-this.margin.top-this.margin.bottom,this.init(),this.plotsManager=new U(2,this.innerHeight),this.mainPlot=new D({name:"candle",type:"candle",barWidth:this.barWidth,barPadding:this.barPadding,parentG:this.rootG,width:this.innerWidth,height:this.plotsManager.positions[0].height,top:this.plotsManager.positions[0].top,xScale:this.xScale,chartDm:this.chartDm}),this.subPlots={volume:new D({name:"volume",type:"volume",barWidth:this.barWidth,barPadding:this.barPadding,parentG:this.rootG,width:this.innerWidth,height:this.plotsManager.positions[1].height,top:this.plotsManager.positions[1].top,xScale:this.xScale,chartDm:this.chartDm}),oi:new D({name:"oi",type:"oi",barWidth:this.barWidth,barPadding:this.barPadding,parentG:this.rootG,yAxisPos:"right",width:this.innerWidth,height:this.plotsManager.positions[1].height,top:this.plotsManager.positions[1].top,xScale:this.xScale,chartDm:this.chartDm})}}return Object(l["a"])(t,[{key:"showLoading",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.loadingG.attr("visibility",t?"visible":"hidden")}},{key:"init",value:function(){this.svg=a["select"]("#"+this.divDomId).append("svg").attr("width",this.outerWidth).attr("height",this.outerHeight),this.rootG=x(this.svg,this.margin.left,this.margin.top),this.loadingG=this.svg.append("g").attr("width",this.outerWidth).attr("height",this.outerHeight).attr("class","loading").append("text").attr("x","50%").attr("y","50%").attr("text-anchor","middle").attr("font-size",50).text("正在加载数据"),this.xScale=a["scaleLinear"]().range([0,this.innerWidth]),this.xAxis=a["axisBottom"]().scale(this.xScale),x(this.rootG,0,this.innerHeight,"x axis"),this.setBarNumbers();var e=null,i=this,n=a["drag"]().on("start",function(){e=a["event"].x}).on("drag",function(){var t=Math.round((a["event"].x-e)/i.barWidth);Math.abs(t)>0&&(e=a["event"].x,i.move(t))}).on("end",function(){e=null});this.svg.call(n);var s=0,r=a["zoom"]().on("zoom",function(){if(s+=a["event"].sourceEvent.deltaY,Math.abs(s)>=t.ZOOM_SENSITIVITY){var e=Math.round(Math.abs(s)/t.ZOOM_SENSITIVITY);e=s>0?e:-e,i.debounce(i.zoom,200).bind(i)(e),s=0}});this.svg.call(r)}},{key:"debounce",value:function(t,e){var i=null;return function(){var n=this,s=arguments;clearTimeout(i),i=setTimeout(function(){t.apply(n,s)},e)}}},{key:"setHeight",value:function(t){for(var e in this.outerHeight=t,this.innerHeight=this.outerHeight-this.margin.top-this.margin.bottom,this.svg.attr("height",this.outerHeight),this.rootG.select("g.x.axis").attr("transform","translate(0,"+this.innerHeight+")"),this.mainPlot.height=.6*this.innerHeight,this.subPlots)this.subPlots[e].height=.4*(this.innerHeight-8);this.draw()}},{key:"setBarNumbers",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chartDm.view_width;if(this.barNumbers=t,this.barWidth=this.innerWidth/this.barNumbers,this.xScale.range([0,this.innerWidth-this.barWidth]),this.rootG.selectAll("g.x.axis").attr("transform","translate("+this.barWidth/2+","+this.innerHeight+")"),console.log(this.barNumbers,this.innerWidth,this.barWidth),this.barPaddingTimes=.2,this.barPadding=this.barWidth*this.barPaddingTimes,this.chartDm.view_width!==this.barNumbers&&(this.chartDm.view_width=this.barNumbers),this.mainPlot)for(var e in this.mainPlot.barWidth=this.barWidth,this.mainPlot.barPadding=this.barPadding,this.subPlots)this.subPlots[e].barWidth=this.barWidth,this.subPlots[e].barPadding=this.barPadding}},{key:"setSymbol",value:function(t){this.chartDm.symbol=t,this.draw()}},{key:"setDuration",value:function(t){this.chartDm.duration=t,this.draw()}},{key:"move",value:function(t){this.chartDm.moves(t),this.draw()}},{key:"zoom",value:function(e){var i=this.innerWidth/(this.barNumbers-e);i>=t.BAR_WIDTH_MIN&&i<=t.BAR_WIDTH_MAX&&(this.setBarNumbers(this.barNumbers-e),this.draw())}},{key:"drawXAxis",value:function(){this.xScale.domain([this.chartDm.left_id,this.chartDm.right_id]);var t=this.chartDm.klines.data;this.xAxis.tickFormat(function(e){return t[e]&&t[e].datetime?M(t[e].datetime/1e6):""}),this.rootG.selectAll("g.x.axis").call(this.xAxis)}},{key:"draw",value:function(){if(-1===this.chartDm.left_id||-1===this.chartDm.right_id)return!1;for(var t in this.showLoading(!1),this.drawXAxis(),this.mainPlot.draw(),this.subPlots)this.subPlots[t].draw()}}]),t}();Object(d["a"])(W,"ZOOM_SENSITIVITY",3),Object(d["a"])(W,"BAR_WIDTH_MAX",50),Object(d["a"])(W,"BAR_WIDTH_MIN",3);var F=W;window.d3=a;var B={"5s":5,"10s":10,"30s":30,"1m":60,"5m":300,"15m":900,"30m":1800,"1H":3600,"1D":86400},$={name:"Chart",components:{},data:function(){return{periods:Object.keys(B),selectedPeriod:"1m"}},computed:{duration:function(){return 1e9*B[this.selectedPeriod]}},props:{instrumentId:{type:String,required:!0,default:"KQ.m@CFFEX.IF"},height:{type:Number,required:!0,default:400}},watch:{instrumentId:{handler:function(t,e){this.$store.commit("SUBSCRIBE_QUOTE",[this.instrumentId]),this.chart&&this.chart.setSymbol(t)},immediate:!0},duration:{handler:function(t,e){this.chart&&this.chart.setDuration(t)},immediate:!0},height:{handler:function(t,e){console.log(t,e),this.chart&&this.chart.setHeight(t-30-2)},immediate:!0}},methods:{handlerChangePeriod:function(t){this.updatePeriod(t)},updatePeriod:function(t){}},mounted:function(){this.$nextTick(function(){var t=this.height-30-2,e=this.$refs.CHART.clientWidth,i={top:10,right:50,bottom:30,left:50};this.chart=new F({id:"CHART",width:e,height:t,margin:i,dm:c["a"],ws:c["b"],instrumentId:this.instrumentId,duration:this.duration})})},destroyed:function(){console.log("destroyed")}},G=$,H=(i("cd60"),i("2877")),Q=Object(H["a"])(G,r,o,!1,null,null,null);Q.options.__file="index.vue";var Y=Q.exports,z={components:{Chart:Y},data:function(){return{instrumentId:this.$route.params.instrument_id}},computed:{height:function(){return console.log(this.$root.windowHeight*this.$root.appSplit),this.$root.windowHeight*this.$root.appSplit}},created:function(){},mounted:function(){},methods:{goBack:function(){this.$router.go(-1)},onKeyChange:function(t){var e=this;function i(i){i.keyCode===t&&e.goBack()}document.addEventListener?document.addEventListener("keypress",i,!0):document.attachEvent("onkeypress",i)}}},K=z,Z=(i("241c"),Object(H["a"])(K,n,s,!1,null,"42c3c361",null));Z.options.__file="Charts.vue";e["default"]=Z.exports},8669:function(t,e,i){},"966f":function(t,e,i){"use strict";var n=i("a436"),s=i.n(n);s.a},a436:function(t,e,i){},ab6f:function(t,e,i){"use strict";var n=i("491c"),s=i.n(n);s.a},b885:function(t,e,i){},cd60:function(t,e,i){"use strict";var n=i("f193"),s=i.n(n);s.a},cfab:function(t,e,i){},cfb6:function(t,e,i){},d860:function(t,e,i){"use strict";var n=i("4bbc"),s=i.n(n);s.a},d930:function(t,e,i){"use strict";i.d(e,"e",function(){return n}),i.d(e,"d",function(){return s}),i.d(e,"a",function(){return r}),i.d(e,"b",function(){return o}),i.d(e,"c",function(){return a});i("f576"),i("28a5");function n(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),i="",n=0;n<t;n++)i+=e[62*Math.random()|0];return i}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return"number"===typeof t?t.toFixed(e):t}function r(t){var e=null;if("number"===typeof t){e=t>1e12&&t<3e12?new Date(t):new Date(t/1e6);var i=e.getFullYear()+"",n=(e.getMonth()+1+"").padStart(2,"0"),s=(e.getDate()+"").padStart(2,"0"),r=(e.getHours()+"").padStart(2,"0"),o=(e.getMinutes()+"").padStart(2,"0"),a=(e.getSeconds()+"").padStart(2,"0"),c=(e.getMilliseconds()+"").padStart(3,"0");return i+"/"+n+"/"+s+"-"+r+":"+o+":"+a+"."+c}return e}function o(t){switch(t){case"BUY":return"买";case"SELL":return"卖";default:return t}}function a(t){switch(t){case"OPEN":return"开";case"CLOSE":return"平昨";case"CLOSETODAY":return"平今";default:return t}}},db49:function(t,e,i){"use strict";i.d(e,"b",function(){return s}),i.d(e,"c",function(){return r}),i.d(e,"e",function(){return o}),i.d(e,"a",function(){return a}),i.d(e,"d",function(){return c});i("cadf"),i("551c"),i("097d");var n=i("d930"),s="https://openmd.shinnytech.com/t/md/symbols/latest.json",r="wss://openmd.shinnytech.com/t/md/front/mobile",o="wss://t.shinnytech.com/trade/shinny",a={bid:"快期模拟"};var c=[{name:"合约代码",prop:"instrument_id",width:100},{name:"最新价",prop:"last_price",width:60,className:function(t){return t["change"]>0?"R":t["change"]<0?"G":""},formatter:function(t){return Object(n["d"])(t["last_price"],t["price_decs"])}},{name:"时间",prop:"datetime",width:100,formatter:function(t){return t["datetime"].slice(11,23)}},{name:"买价",prop:"bid_price1",width:60,className:"col-buy",formatter:function(t){return Object(n["d"])(t["bid_price1"],t["price_decs"])}},{name:"买量",prop:"bid_volume1",width:60,className:"col-buy"},{name:"卖价",prop:"ask_price1",width:60,className:"col-sell",formatter:function(t){return Object(n["d"])(t["ask_price1"],t["price_decs"])}},{name:"卖量",prop:"ask_volume1",width:60,className:"col-sell"},{name:"涨跌",prop:"change",width:60,className:function(t){return t["change"]>0?"R":t["change"]<0?"G":""},formatter:function(t){return Object(n["d"])(t["change"],t["price_decs"])}},{name:"涨跌幅",prop:"change_percent",width:60,className:function(t){return t["change"]>0?"R":t["change"]<0?"G":""},formatter:function(t){var e=Object(n["d"])(t["change"]/t["pre_settlement"]*100,2);return isNaN(e)?"-":e+"%"}},{name:"成交量",prop:"volume",width:60,className:function(t){return t["change"]>0?"R":t["change"]<0?"G":""}},{name:"今开盘",prop:"open",width:60,formatter:function(t){return Object(n["d"])(t["open"],t["price_decs"])}},{name:"收盘",prop:"close",width:60,formatter:function(t){return Object(n["d"])(t["close"],t["price_decs"])}},{name:"涨停",prop:"upper_limit",width:60,formatter:function(t){return Object(n["d"])(t["upper_limit"],t["price_decs"])}},{name:"跌停",prop:"lower_limit",width:60,formatter:function(t){return Object(n["d"])(t["lower_limit"],t["price_decs"])}},{name:"最高价",prop:"highest",width:60,formatter:function(t){return Object(n["d"])(t["highest"],t["price_decs"])}},{name:"最低价",prop:"lowest",width:60,formatter:function(t){return Object(n["d"])(t["lowest"],t["price_decs"])}},{name:"持仓量",prop:"open_interest",width:60},{name:"昨持",prop:"pre_open_interest",width:60},{name:"昨成交",prop:"pre_volume",width:60},{name:"昨收",prop:"pre_close",width:60,formatter:function(t){return Object(n["d"])(t["pre_close"],t["price_decs"])}},{name:"昨结算",prop:"pre_settlement",width:60,formatter:function(t){return Object(n["d"])(t["pre_settlement"],t["price_decs"])}}]},dfaa:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return TqWebsocket});var _Users_yanqiong_Documents_shinny_shinny_futures_web_alpha_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("d4ec"),_Users_yanqiong_Documents_shinny_shinny_futures_web_alpha_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("bee2"),_Users_yanqiong_Documents_shinny_shinny_futures_web_alpha_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("99de"),_Users_yanqiong_Documents_shinny_shinny_futures_web_alpha_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("7e84"),_Users_yanqiong_Documents_shinny_shinny_futures_web_alpha_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("262e"),_event__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("0be0"),TqWebsocket=function(_EventTarget){function TqWebsocket(t){var e;return Object(_Users_yanqiong_Documents_shinny_shinny_futures_web_alpha_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__["a"])(this,TqWebsocket),e=Object(_Users_yanqiong_Documents_shinny_shinny_futures_web_alpha_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__["a"])(this,Object(_Users_yanqiong_Documents_shinny_shinny_futures_web_alpha_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__["a"])(TqWebsocket).call(this)),t instanceof Array?(e.urlList=t,e.url=t[0]):(e.urlList=[t],e.url=t),e.ws=null,e.queue=[],e.reconnect=!0,e.reconnectTask=null,e.reconnectInterval=3e3,e.reconnectMaxTimes=5,e.reconnectTimes=0,e.reconnectUrlIndex=0,e.STATUS={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3},e.init(),e}return Object(_Users_yanqiong_Documents_shinny_shinny_futures_web_alpha_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__["a"])(TqWebsocket,_EventTarget),Object(_Users_yanqiong_Documents_shinny_shinny_futures_web_alpha_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__["a"])(TqWebsocket,[{key:"send",value:function(t){var e="string"===typeof t?t:JSON.stringify(t);this.isReady()?this.ws.send(e):this.queue.push(e)}},{key:"isReady",value:function(){return this.ws.readyState===this.STATUS.OPEN}},{key:"init",value:function init(){this.ws=new WebSocket(this.url);var _this=this;this.ws.onmessage=function(message){var data=eval("("+message.data+")");_this.fire("message",data)},this.ws.onclose=function(t){_this.fire("close"),_this.queue=[],_this.reconnect&&(_this.reconnectTask=setInterval(function(){3===_this.ws.readyState&&_this.init()},_this.reconnectInterval))},this.ws.onerror=function(t){console.error(t),_this.fire("error"),_this.ws.close()},this.ws.onopen=function(){_this.fire("open"),this.reconnectTask&&(clearInterval(_this.reconnectTask),_this.fire("reconnect"));while(_this.queue.length>0){if(1!==_this.ws.readyState)break;_this.ws.send(_this.queue.shift())}}}}]),TqWebsocket}(_event__WEBPACK_IMPORTED_MODULE_5__["a"])},e86d:function(t,e,i){"use strict";var n=i("8669"),s=i.n(n);s.a},f193:function(t,e,i){},f8fe:function(t,e,i){"use strict";var n=i("cfb6"),s=i.n(n);s.a}});